<div class="container">

<table style="width: 100%;"><tr>
<td>wt.avg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plot of wavelet power averages across time of a single time series
</h2>

<h3>Description</h3>

<p>This function plots wavelet power averages across time of a single time
series, which are provided by an object of class <code>"analyze.wavelet"</code>, 
or alternatively of class <code>"analyze.coherency"</code>. 
(In the latter case, the series number or name must be specified.) 
The vertical axis shows the Fourier periods. The horizontal axis shows the averages.
User-defined minimum and maximum average levels can be applied. 
Also, an option is given to individualize the period axis and/or axis of averages 
by specifying tick marks and labels.
</p>
<p>There is an option to label periods according to significance of
averages (if p-values are provided) at given levels of significance.
Labels are point symbols along the
line of averages which can be assigned individually.
</p>
<p>The idea to show significance levels by colors of plotting characters and its 
implementation has been adopted from Huidong Tian and Bernard Cazelles 
(archived R package <code>WaveletCo</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">wt.avg(WT, my.series = 1, exponent = 1,
  show.siglvl = TRUE, siglvl = c(0.05, 0.1), 
  sigcol = c("red", "blue"), sigpch = 20, sigcex = 1,
  minimum.level = NULL, maximum.level = NULL,
  label.avg.axis = TRUE, 
  averagelab = NULL, averagetck = 0.02, averagetcl = 0.5,
  spec.avg.axis = list(at = NULL, labels = TRUE, 
                       las = 1, hadj = NA, padj = NA),
  label.period.axis = TRUE, 
  periodlab = NULL, periodtck = 0.02, periodtcl = 0.5,
  spec.period.axis = list(at = NULL, labels = TRUE, 
                          las = 1, hadj = NA, padj = NA),
  show.legend = TRUE, legend.coords = "topright", 
  main = NULL, 
  lwd = 1, col = 1, 
  lwd.axis = 1,
  verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>WT</code></td>
<td>
<p>an object of class <code>"analyze.wavelet"</code> or <code>"analyze.coherency"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>my.series</code></td>
<td>
<p>In case <code>class(WT) = "analyze.coherency"</code>: number (<code>1</code> or <code>2</code>) or name of 
the series to be analyzed. 
</p>
<p>Default: <code>1</code>. </p>
</td>
</tr>
</table>
<table><tr style="vertical-align: top;">
<td><code>exponent</code></td>
<td>
<p>Exponent applied to averages before plotting; 
the exponent should be positive.
</p>
<p>Default: <code>1</code>.
</p>
</td>
</tr></table>
<table>
<tr style="vertical-align: top;">
<td><code>show.siglvl</code></td>
<td>
<p>Label periods according to significance of averages? (Effective only if p-values are provided.) 
</p>
<p>Default: <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>siglvl</code></td>
<td>
<p>a vector of significance levels (of any length and order). Default: <code>c(0.05, 0.1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigcol</code></td>
<td>
<p>a vector of colors (should be of same length as and correspond to <code>siglvl</code>, 
otherwise colors <code>1 : length(siglvl)</code>).
</p>
<p>Default: <code>c("red","blue")</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigpch</code></td>
<td>
<p>a vector of plotting "characters" (symbols) to use as labels of significance. 
(It should be of same length as and correspond to <code>siglvl</code> to produce different plotting labels, 
otherwise the default setting is used. A single input value affects all labels.) 
</p>
<p>Default: <code>20</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigcex</code></td>
<td>
<p>a numerical vector working as size of labels of significance. 
(It should be of same length as and correspond to <code>siglvl</code> to produce different-sized labels, 
otherwise the default setting is used.  A single input value affects all labels. 
Note that <code>sigcex</code> is affected by <code>cex</code> in <code>par</code>.) 
</p>
<p>Default: <code>1</code>.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>minimum.level</code></td>
<td>
<p>Minimum plot level of wavelet power averages considered. 
</p>
<p>Default: NULL (referring to minimum level observed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maximum.level</code></td>
<td>
<p>Maximum plot level of wavelet power averages considered. 
</p>
<p>Default: NULL (referring to maximum level observed).</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>label.avg.axis</code></td>
<td>
<p>Label the axis of averages? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>averagelab</code></td>
<td>
<p>Label for the axis of averages. 
</p>
<p>Default: <code>"average wavelet power"</code>.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>averagetck</code></td>
<td>
<p>length of tick marks on the axis of averages as a fraction of the smaller of the width or height of 
the plotting region; see <code>par</code>.  
If <code>averagetck &gt;= 0.5</code>, <code>averagetck</code> is interpreted as a fraction of the length of the axis of averages, 
so if <code>averagetck = 1</code> (and <code>averagetcl = NULL</code>), vertical grid lines will be drawn. <br>
Setting <code>averagetck = NA</code> is to use <code>averagetcl = -0.5</code> (which is the R default setting of <code>tck</code> and <code>tcl</code>).
</p>
<p>Default here: <code>0.02</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>averagetcl</code></td>
<td>
<p>length of tick marks on the axis of averages as a fraction of the height of a line of text; see <code>par</code>. 
With <code>averagetcl = -0.5</code> (which is the R default setting of <code>tcl</code>) ticks will be drawn outward.
</p>
<p>Default here: <code>0.5</code>.</p>
</td>
</tr>
</table>
<table><tr style="vertical-align: top;">
<td><code>spec.avg.axis</code></td>
<td>
<p>a list of tick mark and label specifications for individualized labeling of the axis of averages 
(only effective if <code>label.avg.axis = TRUE</code>):
</p>

<ul>
<li>
<p>[<code>at</code>:] locations of tick marks (when <code>NULL</code>, default plotting will be applied). Valid tick marks can be provided as 
numerical and non-negative values only. <br>
Default: <code>NULL</code>.
</p>
</li>
<li>
<p>[<code>labels</code>:] either a logical value specifying whether annotations at the tick marks are the tick marks themselves, 
or any vector of labels. If <code>labels</code> is non-logical, <code>at</code> should be of same length. <br>
Default: <code>TRUE</code>. 
</p>
</li>
<li>
<p>[<code>las</code>:] the style of axis labels, see <code>par</code>. <br>
Default: <code>1</code> (always horizontal).
</p>
</li>
<li>
<p>[<code>hadj</code>:] adjustment of labels horizontal to the reading direction, see <code>axis</code>. <br>
Default: <code>NA</code> (centering is used). 
</p>
</li>
<li>
<p>[<code>padj</code>:] adjustment of labels perpendicular to the reading direction (this can be a vector of adjustments for each label), 
see <code>axis</code>. <br>
Default: <code>NA</code> (centering is used).                           
</p>
</li>
</ul>
<p>Mismatches will result in a reset to default plotting.                               
</p>
</td>
</tr></table>
<table>
<tr style="vertical-align: top;">
<td><code>label.period.axis</code></td>
<td>
<p>Label the (Fourier) period axis? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>periodlab</code></td>
<td>
<p>(Fourier) period axis label. 
</p>
<p>Default: <code>"period"</code>.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>periodtck</code></td>
<td>
<p>length of tick marks on the period axis as a fraction of the smaller of the width or height 
of the plotting region; see <code>par</code>. If <code>periodtck &gt;= 0.5</code>, <code>periodtck</code> is interpreted as a fraction
of the length of the period axis, so if <code>periodtck = 1</code> (and <code>periodtcl = NULL</code>), horizontal grid lines will be drawn. <br>
Setting <code>periodtck = NA</code> is to use <code>periodtcl = -0.5</code> (which is the R default setting of <code>tck</code> and <code>tcl</code>).
</p>
<p>Default here: <code>0.02</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>periodtcl</code></td>
<td>
<p>length of tick marks on the period axis as a fraction of the height of a line of text; see <code>par</code>. 
With <code>periodtcl = -0.5</code> (which is the R default setting of <code>tcl</code>) ticks will be drawn outward. 
</p>
<p>Default here: <code>0.5</code>.</p>
</td>
</tr>
</table>
<table><tr style="vertical-align: top;">
<td><code>spec.period.axis</code></td>
<td>
<p>a list of tick mark and label specifications for individualized period axis labeling 
(only effective if <code>label.period.axis = TRUE</code>):
</p>

<ul>
<li>
<p>[<code>at</code>:] locations of tick marks (when <code>NULL</code>, default plotting will be applied). Valid tick marks can be provided as 
numerical and positive values only. <br>
Default: <code>NULL</code>.        
</p>
</li>
<li>
<p>[<code>labels</code>:] either a logical value specifying whether annotations at the tick marks are the tick marks themselves, 
or any vector of labels. If <code>labels</code> is non-logical, <code>at</code> should be of same length. <br>
Default: <code>TRUE</code>. 
</p>
</li>
<li>
<p>[<code>las</code>:] the style of axis labels, see <code>par</code>. <br>
Default: <code>1</code> (always horizontal). 
</p>
</li>
<li>
<p>[<code>hadj</code>:] adjustment of labels horizontal to the reading direction, see <code>axis</code>. <br>
Default: <code>NA</code> (centering is used). 
</p>
</li>
<li>
<p>[<code>padj</code>:] adjustment of labels perpendicular to the reading direction (this can be a vector of adjustments for each label), 
see <code>axis</code>. <br>
Default: <code>NA</code> (centering is used).                           
</p>
</li>
</ul>
<p>Mismatches will result in a reset to default plotting.                               
</p>
</td>
</tr></table>
<table>
<tr style="vertical-align: top;">
<td><code>show.legend</code></td>
<td>
<p>Include legend of significance levels into the plot? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.coords</code></td>
<td>
<p>coordinates to position the legend (as in function <code>legend</code>). 
</p>
<p>Default: <code>"topright"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>an overall title for the plot. 
</p>
<p>Default: <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>width of line of averages. 
</p>
<p>Default: <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>color of line of averages. 
</p>
<p>Default: <code>"black"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.axis</code></td>
<td>
<p>line width of axes. 
</p>
<p>Default: <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print verbose output on the screen? Logical. 
</p>
<p>Default: <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Angi Roesch and Harald Schmidbauer; credits are also due to Huidong Tian and Bernard Cazelles</p>


<h3>References</h3>

<p>Aguiar-Conraria L., and Soares M.J., 2011. 
The Continuous Wavelet Transform: A Primer. 
NIPE Working Paper Series 16/2011.
</p>
<p>Carmona R., Hwang W.-L., and Torresani B., 1998. 
Practical Time Frequency Analysis. Gabor and Wavelet Transforms with an Implementation in S.
Academic Press, San Diego.
</p>
<p>Cazelles B., Chavez M., Berteaux, D., Menard F., Vik J.O., Jenouvrier S., and Stenseth N.C., 2008.
Wavelet analysis of ecological time series.
Oecologia 156, 287–304.
</p>
<p>Liu Y., Liang X.S., and Weisberg R.H., 2007.
Rectification of the Bias in the Wavelet Power Spectrum. 
Journal of Atmospheric and Oceanic Technology 24, 2093–2102.
</p>
<p>Tian, H., and Cazelles, B., 2012. <code>WaveletCo</code>. 
Available at <a href="https://cran.r-project.org/src/contrib/Archive/WaveletCo/">https://cran.r-project.org/src/contrib/Archive/WaveletCo/</a>, archived April 2013; accessed July 26, 2013.
</p>
<p>Torrence C., and Compo G.P., 1998. 
A practical guide to wavelet analysis. 
Bulletin of the American Meteorological Society 79 (1), 61–78.
</p>


<h3>See Also</h3>

 
<p><code>analyze.wavelet</code>, <code>wt.image</code>, <code>wt.sel.phases</code>, <code>wt.phase.image</code>, <code>reconstruct</code> 
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## The following example is adopted from Liu et al., 2007:

series.length &lt;- 6*128*24
x1 &lt;- periodic.series(start.period = 1*24, length = series.length)
x2 &lt;- periodic.series(start.period = 8*24, length = series.length)
x3 &lt;- periodic.series(start.period = 32*24, length = series.length)
x4 &lt;- periodic.series(start.period = 128*24, length = series.length)

x &lt;- x1 + x2 + x3 + x4

plot(x, type = "l", xlab = "index", ylab = "", xaxs = "i",
     main = "hourly series with periods of 1, 8, 32, 128 days")
        
my.data &lt;- data.frame(x = x)

## Computation of wavelet power:
## a natural choice of 'dt' in the case of hourly data is 'dt = 1/24',
## resulting in one time unit equaling one day. 
## This is also the time unit in which periods are measured. 
my.wt &lt;- analyze.wavelet(my.data, "x", loess.span = 0, 
                         dt = 1/24, dj = 1/20, 
                         lowerPeriod = 1/4,
                         make.pval = TRUE, n.sim = 10)

## Plot of wavelet power spectrum (with equidistant color breakpoints): 
wt.image(my.wt, color.key = "i", main = "wavelet power spectrum",
   legend.params = list(lab = "wavelet power levels (equidistant levels)"),
   periodlab = "period (days)")
## Note:
## The default time axis shows an index of given points in time, 
## which is the count of hours in our example.
         
## With time elapsed in days 
## (starting from 0 and proceeding in steps of 50 days) 
## instead of the (default) time index:
index.ticks  &lt;- seq(1, series.length, by = 50*24)
index.labels &lt;- (index.ticks-1)/24

## Insert your specification of time axis: 
wt.image(my.wt, color.key = "i", main = "wavelet power spectrum",
   legend.params = list(lab = "wavelet power levels (equidistant levels)"),
   periodlab = "period (days)", timelab = "time elapsed (days)",
   spec.time.axis = list(at = index.ticks, labels = index.labels))
         
## Plot of average wavelet power:
wt.avg(my.wt, siglvl = 0.05, sigcol = "red", periodlab = "period (days)")

## The same plot, but with enhanced symbol size, user-defined period axis, 
## and horizontal grid:
wt.avg(my.wt, siglvl = 0.05, sigcol = "red", sigcex = 1.3, 
   periodlab = "period (days)",
   spec.period.axis = list(at = c(1,8,32,128)), 
   periodtck = 1, periodtcl = NULL, 
   lwd = 1.5, lwd.axis = 0.25)
       
## Another style of the plot: 
## With user-defined period axis and axis of averages, 
## minimum and maximum plot levels of averages:

op &lt;- par(no.readonly = TRUE)
par(cex.lab = 1.3, cex.axis = 1.1)
wt.avg(my.wt, siglvl = 0.05, sigcol = "red", sigcex = 1.3, 
   minimum.level = 0, maximum.level = 11,
   periodlab = "period (days)", 
   spec.period.axis = list(at = c(1,8,32,128)), 
   spec.avg.axis = list(at = 0:10),
   lwd = 1.5)
par(op)   
## Note:
## 'cex.axis' in 'par' controls for the size of axis tick labels, 
## while 'cex.lab' controls for the size of axis and legend labels. 
## Scaling by 'cex' would also affect 'sigcex'. 


## Please see also the examples in our guide booklet,
## URL http://www.hs-stat.com/projects/WaveletComp/WaveletComp_guided_tour.pdf.


## End(Not run)
</code></pre>


</div>