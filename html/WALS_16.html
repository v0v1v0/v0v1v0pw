<div class="container">

<table style="width: 100%;"><tr>
<td>familyWALS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extended Family Objects for Models</h2>

<h3>Description</h3>

<p>Objects of class <code>"familyWALS"</code> inherit from <code>"family"</code>
and extend those with (transformation) functions required for
<code>walsGLM</code> and <code>walsNB</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">familyWALS(object, ...)

poissonWALS(link = "log")

binomialWALS(link = "logit")

negbinFixedWALS(scale, link)

negbinWALS(scale, link)

## S3 method for class 'walsGLM'
familyWALS(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>The function <code>familyWALS()</code> extracts the family objects stored
in <code>"walsGLM"</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to methods.
</p>
<p>The <code>negbinWALS()</code> family currently only accepts <code>"log"</code>, while
<code>negbinFixedWALS()</code> supports both <code>"log"</code> and <code>"canonical"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>Specifies the model link function. Typically a character string
or an object of class <code>"link-glm"</code> generated by
<code>make.link</code>. See <code>family</code> for more details.
Currently, only a limited number of links are supported. See below for more
details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>dispersion parameter of NB2 to be used, always larger than 0.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>familyWALS()</code> is a generic function that extracts the family used in
<code>"walsGLM"</code> objects.
</p>
<p><code>negbinFixedWALS()</code> creates the <code>"familyWALS"</code> object for negative
binomial distribution type 2 (NB2) with fixed dispersion parameter. It extends
<code>negativeBinomial</code>.
</p>
<p><code>negbinWALS()</code> creates objects of the specialized class <code>"familyNBWALS"</code>
which inherits from <code>"familyWALS"</code> and <code>"family"</code>. It constructs the
<code>"familyNBWALS"</code> object for the negative binomial distribution type 2 (NB2)
with variable dispersion parameter by extending <code>negativeBinomial</code>
and <code>negbinFixedWALS</code> with functions required in <code>walsNB.</code>
<strong><code>negbinWALS</code> should only be used in <code>walsNBfit</code> and
not in <code>walsGLM</code> because the NB2 with variable dispersion
parameter is not a GLM!</strong>
</p>


<h4>Supported links</h4>

<p>Currently, <code>binomialWALS()</code> and <code>poissonWALS()</code> only support their
canonical links, i.e. <code>"logit"</code> and <code>"log"</code>, respectively.
<code>negbinFixedWALS()</code> supports both, the <code>"canonical"</code> link and
the <code>"log"</code> link, however, the first is not recommended due to numerical
difficulties in the fitting process. In contrast, <code>negbinWALS()</code> only
supports the <code>"log"</code> link.
</p>



<h3>Value</h3>

<p>An object of class <code>"familyWALS"</code> to be used in
<code>walsGLM</code> that inherits from <code>"family"</code>.
This is a list that contains elements returned from the corresponding family
function that it extends. Additionally, the following elements are available:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>theta.eta</code></td>
<td>
<p>function. Derivative of the canonical parameter <code class="reqn">\theta</code>
with respect to the linear link <code class="reqn">\eta</code>, i.e. <code class="reqn">d \theta / d \eta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>function. <code class="reqn">\psi</code> defined on p. 3 of (De Luca et al. 2018).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initializeY</code></td>
<td>
<p>function. Preprocesses the response, e.g. in
<code>binomialWALS()</code> it transforms factors to numeric 0s and 1s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transformY</code></td>
<td>
<p>function. Transforms the response to <code class="reqn">\bar{y}</code>.
See eq. (5) in (De Luca et al. 2018) for GLMs and
(Huynh 2024a) for <code>negbinWALS()</code> used in
<code>walsNB</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transformX</code></td>
<td>
<p>function. Transforms the regressors to <code class="reqn">\bar{X}_1</code> and
<code class="reqn">\bar{X}_2</code>, respectively. See eq. (5) in (De Luca et al. 2018)
for GLMs and (Huynh 2024a) for <code>negbinWALS()</code> used in
<code>walsNB</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>function. The probability density/mass function of the family.</p>
</td>
</tr>
</table>
<p><code>poissonWALS()</code> and <code>negbinFixedWALS()</code> return objects of class
<code>"familyWALScount"</code> that inherit from <code>"familyWALS"</code> and
<code>"family"</code>. These are lists that contain the same elements as
<code>"familyWALS"</code> objects described above.
</p>
<p><code>negbinWALS()</code> creates an object of class <code>"familyNBWALS"</code>
(only used internally in <code>walsNB</code>) that inherits from
<code>"familyWALScount"</code>, <code>"familyWALS"</code> and <code>"family"</code>.
This is a list that contains all elements returned from <code>negbinFixed</code>
and the elements described above for objects of class <code>"familyWALS"</code>.
Additionally contains the following elements with functions required in
<code>walsNB</code> that are described in
(Huynh 2024a):
</p>
<table>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>function. Computes <code class="reqn">\bar{q}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>function. Computes <code class="reqn">\bar{g}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transformY0</code></td>
<td>
<p>function. Computes <code class="reqn">\bar{y}_0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>function. Computes <code class="reqn">\bar{t}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>function. Computes <code class="reqn">\bar{\epsilon}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsiloninv</code></td>
<td>
<p>function. Computes <code class="reqn">\bar{\epsilon}^{-1}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappaSum</code></td>
<td>
<p>function. Computes <code class="reqn">\bar{\kappa}^{\top} \mathbf{1}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>computeAlpha</code></td>
<td>
<p>function. Computes the log-dispersion parameter
<code class="reqn">\log(\rho)</code> given (model-averaged) estimates of the regression
coefficients of the transformed regressors <code class="reqn">\gamma_{1}</code> and <code class="reqn">\gamma_{2}</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>De Luca G, Magnus JR, Peracchi F (2018).
“Weighted-average least squares estimation of generalized linear models.”
<em>Journal of Econometrics</em>, <b>204</b>(1), 1–17.
<a href="https://doi.org/10.1016/j.jeconom.2017.12.007">doi:10.1016/j.jeconom.2017.12.007</a>.<br><br> Huynh K (2024a).
“Weighted-Average Least Squares for Negative Binomial Regression.”
arXiv 2404.11324, arXiv.org E-Print Archive.
<a href="https://doi.org/10.48550/arXiv.2404.11324">doi:10.48550/arXiv.2404.11324</a>.
</p>


<h3>See Also</h3>

<p>family, walsGLM.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Use in walsGLM():
data("NMES1988", package = "AER")
NMES1988 &lt;- na.omit(NMES1988)
fitPoisson &lt;- walsGLM(emergency ~ health + chronic + age + gender |
                       I((age^2)/10) + married + region, family = poissonWALS(),
                      data = NMES1988, prior = laplace())
summary(fitPoisson)

## Plot derivatives of binomialWALS() with default 'logit' link:
bi &lt;- binomialWALS()
plot(bi$mu.eta, from = -10, to = 10)
plot(bi$theta.eta, from = -10, to = 10) # constant. logit is canonical link

</code></pre>


</div>