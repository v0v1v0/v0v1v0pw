<div class="container">

<table style="width: 100%;"><tr>
<td>VolcanoPlotW</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Volcano-Plot (Statistical Test Outcome versus Relative Change)</h2>

<h3>Description</h3>

<p>This type of plot is very common in high-throughput biology, see <a href="https://en.wikipedia.org/wiki/Volcano_plot_(statistics)">Volcano-plot</a>.
Basically, this plot allows comparing the outcome of a statistical test to the relative change (ie log fold-change, M-value).
</p>


<h3>Usage</h3>

<pre><code class="language-R">VolcanoPlotW(
  Mvalue,
  pValue = NULL,
  useComp = 1,
  filtFin = NULL,
  ProjNa = NULL,
  FCthrs = NULL,
  FdrList = NULL,
  FdrThrs = NULL,
  FdrType = NULL,
  subTxt = NULL,
  grayIncrem = TRUE,
  col = NULL,
  pch = 16,
  compNa = NULL,
  batchFig = FALSE,
  cexMa = 1.8,
  cexLa = 1.1,
  limM = NULL,
  limp = NULL,
  annotColumn = c("SpecType", "GeneName", "EntryName", "Accession", "Species", "Contam"),
  annColor = NULL,
  expFCarrow = FALSE,
  cexPt = NULL,
  cexSub = NULL,
  cexTxLab = 0.7,
  namesNBest = NULL,
  NbestCol = 1,
  sortLeg = "descend",
  NaSpecTypeAsContam = TRUE,
  useMar = c(6.2, 4, 4, 2),
  returnData = FALSE,
  callFrom = NULL,
  silent = FALSE,
  debug = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Mvalue</code></td>
<td>
<p>(MArrayLM-object, numeric or matrix) data to plot; M-values are typically calculated as difference of log2-abundance values and 'pValue' the mean of log2-abundance values;
M-values and p-values may be given as 2 columsn of a matrix, in this case the argument <code>pValue</code> should remain NULL.
One may also furnish MArrayLM-objects created bpackage wrProteo or limma.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pValue</code></td>
<td>
<p>(numeric, list or data.frame) if <code>NULL</code> it is assumed that 2nd column of 'Mvalue' contains the p-values to be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useComp</code></td>
<td>
<p>(integer, length=1) choice of which of multiple comparisons to present in <code>Mvalue</code> (if generated using <code>moderTestXgrp()</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filtFin</code></td>
<td>
<p>(matrix or logical) The data may get filtered before plotting: If <code>FALSE</code> no filtering will get applied; if matrix of <code>TRUE</code>/<code>FALSE</code> it will be used as optional custom filter, otherwise (if <code>Mvalue</code> if an <code>MArrayLM</code>-object eg from limma) a default filtering based on the <code>filtFin</code> element will be applied</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ProjNa</code></td>
<td>
<p>(character) custom title</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FCthrs</code></td>
<td>
<p>(numeric) Fold-Change threshold (display as line) give as Fold-change and NOT log2(FC), default at 1.5, set to <code>NA</code> for omitting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FdrList</code></td>
<td>
<p>(numeric) FDR data or name of list-element</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FdrThrs</code></td>
<td>
<p>(numeric) FDR threshold (display as line), default at 0.05, set to <code>NA</code> for omitting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FdrType</code></td>
<td>
<p>(character) FDR-type to extract if <code>Mvalue</code> is 'MArrayLM'-object (eg produced by from <code>moderTest2grp</code> etc);
if <code>NULL</code> it will search for suitable fields/values in this order : 'FDR','BH','lfdr' and 'BY'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subTxt</code></td>
<td>
<p>(character) custom sub-title</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grayIncrem</code></td>
<td>
<p>(logical) if <code>TRUE</code>, display overlay of points  (not exceeding thresholds) as increased shades of gray</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>(character) custom color(s) for points of plot (see also <code>par</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>(integer) type of symbol(s) to plot (default=16) (see also <code>par</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compNa</code></td>
<td>
<p>(character) names of groups compared</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batchFig</code></td>
<td>
<p>(logical) if <code>TRUE</code> figure title and axes legends will be kept shorter for display on fewer splace</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cexMa</code></td>
<td>
<p>(numeric) font-size of title, as expansion factor (see also <code>cex</code> in <code>par</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cexLa</code></td>
<td>
<p>(numeric) size of axis-labels, as expansion factor (see also <code>cex</code> in <code>par</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limM</code></td>
<td>
<p>(numeric, length=2) range of axis M-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limp</code></td>
<td>
<p>(numeric, length=2) range of axis FDR / p-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annotColumn</code></td>
<td>
<p>(character) column names of annotation to be extracted (only if <code>Mvalue</code> is <code>MArrayLM</code>-object containing matrix $annot).
The first entry (typically 'SpecType') is used for different symbols in figure, the second (typically 'GeneName') is used as prefered text for annotating the best points (if <code>namesNBest</code> allows to do so.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annColor</code></td>
<td>
<p>(character or integer) colors for specific groups of annotation (only if <code>Mvalue</code> is <code>MArrayLM</code>-object containing matrix $annot)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expFCarrow</code></td>
<td>
<p>(logical, character or numeric) optional adding arrow for expected fold-change; if <code>TRUE</code> the expected ratio will be extracted from numeric concentration-indications from sample-names
if <code>numeric</code> an arrow will be drawn (M-value as 1st position, color of 2nd position of vector).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cexPt</code></td>
<td>
<p>(numeric) size of points, as expansion factor (see also <code>cex</code> in <code>par</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cexSub</code></td>
<td>
<p>(numeric) size of subtitle, as expansion factor (see also <code>cex</code> in <code>par</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cexTxLab</code></td>
<td>
<p>(numeric) size of text-labels for points, as expansion factor (see also <code>cex</code> in <code>par</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>namesNBest</code></td>
<td>
<p>(integer or character) for display of labels to points in figure: if 'pass','passThr' or 'signif' all points passing thresholds; if numeric (length=1) this number of best points will get labels
if the initial object <code>Mvalue</code> contains a list-element called 'annot' the second of the column specified in argument <code>annotColumn</code> will be used as text</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NbestCol</code></td>
<td>
<p>(character or integer) colors for text-labels of best points, also used for arrow</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sortLeg</code></td>
<td>
<p>(character) sorting of 'SpecType' annotation either ascending ('ascend') or descending ('descend'), no sorting if <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NaSpecTypeAsContam</code></td>
<td>
<p>(logical) consider lines/proteins with <code>NA</code> in Mvalue$annot[,"SpecType"] as contaminants (if a 'SpecType' for contaminants already exits)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useMar</code></td>
<td>
<p>(numeric,length=4) custom margings (see also <code>par</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnData</code></td>
<td>
<p>(logical) optional returning data.frame with (ID, Mvalue, pValue, FDRvalue, passFilt)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>callFrom</code></td>
<td>
<p>(character) allow easier tracking of messages produced</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>(logical) suppress messages</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>(logical) additional messages for debugging</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In high-throughput biology data are typically already transformed to log2 and thus, the 'M'-values (obtained by subtrating two group means) represent a relative change.
Output from statistical testing by <code>moderTest2grp</code> or <code>moderTestXgrp</code> can be directly read to produce Volcano plots for diagnostic reasons.
Please note, that plotting a very high number of points (eg &gt;10000) in transparency may take several seconds.
</p>


<h3>Value</h3>

<p>This function simply plots an MA-plot (to the current graphical device), if <code>returnData=TRUE</code> an optional data.frame with (ID, Mvalue, pValue, FDRvalue, passFilt) can be returned
</p>


<h3>See Also</h3>

<p>(for PCA) <code>plotPCAw</code>)
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(wrMisc)
set.seed(2005); mat &lt;- matrix(round(runif(900),2), ncol=9)
rownames(mat) &lt;- paste0(rep(letters[1:25], each=4), rep(letters[2:26],4))
mat[1:50,4:6] &lt;- mat[1:50,4:6] + rep(c(-1,1)*0.1,25)
mat[3:7,4:9] &lt;- mat[3:7,4:9] + 0.7
mat[11:15,1:6] &lt;- mat[11:15,1:6] - 0.7
## assume 2 groups with 3 samples each
gr3 &lt;- gl(3, 3, labels=c("C","A","B"))
tRes2 &lt;- moderTest2grp(mat[,1:6], gl(2,3), addResults = c("FDR","means"))
# Note: due to the small number of lines only FDR chosen to calculate
VolcanoPlotW(tRes2)
## Add names of points passing custom filters
VolcanoPlotW(tRes2, FCth=1.3, FdrThrs=0.2, namesNBest="passThr")

## assume 3 groups with 3 samples each
tRes &lt;- moderTestXgrp(mat, gr3, addResults = c("FDR","means"))
# Note: due to the small number of lines only FDR chosen to calculate
VolcanoPlotW(tRes)
VolcanoPlotW(tRes, FCth=1.3, FdrThrs=0.2)
VolcanoPlotW(tRes, FCth=1.3, FdrThrs=0.2, useComp=2)

</code></pre>


</div>