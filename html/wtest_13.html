<div class="container">

<table style="width: 100%;"><tr>
<td>w.diagnosis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>W-test Probability Distribution Diagnostic Plot</h2>

<h3>Description</h3>

<p>Diagnostic checking of W-test probability distribution estimation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">w.diagnosis(data, w.order = c(1, 2), n.rep = 10,
  n.sample = nrow(data), n.marker = ncol(data), hf1 = "default.hf1",
  hf2 = "default.hf2", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame or matrix containing genotypes in the columns. Genotypes should be coded as (0, 1, 2) or (0, 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w.order</code></td>
<td>
<p>an integer value of 0 or 1. <code>w.order</code> = 1 gives main effect calculation; <code>w.order</code> = 2 gives pairwise calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.rep</code></td>
<td>
<p>a numeric value, the number of bootstrapping times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.sample</code></td>
<td>
<p>a numeric value, the number of samples to use in bootstrapping. Default is the total number of samples in the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.marker</code></td>
<td>
<p>a numeric value, the number of markers to use in bootstrapping. Default is the total number of markers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hf1</code></td>
<td>
<p><em>h</em> and <em>f</em> values to calculate main effect, organized as a matrix, with columns (<em>k</em>, <em>h</em>, <em>f</em>), <em>k</em> = 2 to 3. Needed when <code>w.order</code> = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hf2</code></td>
<td>
<p><em>h</em> and <em>f</em> values to calculate interaction associations, organized as a matrix, with columns (<em>k</em>, <em>h</em>, <em>f</em>), <em>k</em> = 2 to 9. Needed when <code>w.order</code> = 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>graphical parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function evaluates the input W values of main or interaction effects using a set of null Y by the <code>W-test</code>, and the evaluation is performed in several bootstrap samples to achieve fast and stable output. The W histogram and its theoretical Chi-squared distribution density with <em>f</em> degrees of freedom are plotted indexed by <em>k</em>. Close overlaying of the histogram and the probability density curve indicates that the estimated <em>h</em> and <em>f</em> give a good test statistic probability distribution.
</p>


<h3>Author(s)</h3>

<p>Rui Sun, Maggie Haitian Wang
</p>


<h3>References</h3>

<p>Maggie Haitian Wang, Rui Sun, Junfeng Guo, Haoyi Weng, Jack Lee, Inchi Hu, Pak Sham and Benny C.Y. Zee (2016). A fast and powerful W-test for pairwise epistasis testing. Nucleic Acids Research. doi:10.1093/nar/gkw347.
</p>


<h3>See Also</h3>

<p><code>wtest</code>, <code>hf</code>, <code>w.qqplot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(diabetes.geno)
# Please note that parameter B is recommended to be greater than 400.
hf1 &lt;- hf(data = diabetes.geno, w.order = 1, B = 100)
hf2 &lt;- hf(data = diabetes.geno, w.order = 2, B = 50)
w.diagnosis(diabetes.geno, w.order = 1, n.rep = 100, hf1 = hf1, main=NULL, xlab=NULL, ylab=NULL)
w.diagnosis(diabetes.geno, w.order = 2, n.rep = 100, hf2 = hf2, main=NULL, xlab=NULL, ylab=NULL)
</code></pre>


</div>