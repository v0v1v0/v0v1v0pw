<div class="container">

<table style="width: 100%;"><tr>
<td>Wdensities</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute densities of weights of evidence in cases and controls</h2>

<h3>Description</h3>

<p>The function computes smoothed densities of the weight of evidence in
cases and in controls from the crude probabilities, then adjusts them to
make them mathematically consistent so that p(W_ctrl) = exp(-W) p(W_case).
</p>


<h3>Usage</h3>

<pre><code class="language-R">Wdensities(y, posterior.p, prior.p, range.xseq = c(-25, 25),
  x.stepsize = 0.01, adjust.bw = 1, recalibrate = TRUE,
  debug = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Binary outcome label (0 for controls, 1 for cases).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posterior.p</code></td>
<td>
<p>Vector of posterior probabilities generated by using model
to predict on test data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.p</code></td>
<td>
<p>Vector of prior probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range.xseq</code></td>
<td>
<p>Range of points where the curves should be sampled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.stepsize</code></td>
<td>
<p>Distance between each point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust.bw</code></td>
<td>
<p>Bandwidth adjustment for the Gaussian kernel density
estimator. By default it is set to 1 (no adjustment), setting it to
a value smaller/larger than 1 reduces/increases the smoothing of
the kernel. This argument is ignored if more than one mixture component
is identified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recalibrate</code></td>
<td>
<p>If <code>TRUE</code> (the default) the weights of evidence are
calculated after the posterior probabilities have been recalibrated
against <code>y</code> using a logistic regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>If <code>TRUE</code>, the size of the adjustment is reported.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the sample distributions in cases and controls support a 2-component
mixture model (based on model comparison with BIC) for the densities, this
will be detected and a 2-component mixture model will be fitted before
adjustment.
</p>


<h3>Value</h3>

<p>A densities object that contains the information necessary to compute
summary measures and generate plots.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(cleveland)
densities &lt;- with(cleveland, Wdensities(y, posterior.p, prior.p))

# Example which requires fitting a mixture distribution
data(fitonly)
densities &lt;- with(fitonly, Wdensities(y, posterior.p, prior.p))

</code></pre>


</div>