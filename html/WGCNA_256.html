<div class="container">

<table style="width: 100%;"><tr>
<td>simulateSmallLayer</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Simulate small modules </h2>

<h3>Description</h3>

<p>This function simulates a set of small modules. The primary purpose is to add a submodule structure to
the main module structure simulated by <code>simulateDatExpr</code>. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulateSmallLayer(
  order, 
  nSamples, 
  minCor = 0.3, maxCor = 0.5, corPower = 1, 
  averageModuleSize, 
  averageExpr, 
  moduleSpacing, 
  verbose = 4, indent = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p> a vector giving the simulation order for vectors. See details. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nSamples</code></td>
<td>
<p> integer giving the number of samples to be simulated. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minCor</code></td>
<td>
<p> a multiple of <code>maxCor</code> (see below) giving the minimum correlation of module genes
with the corresponding eigengene. See details. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxCor</code></td>
<td>
<p> maximum correlation of module genes with the corresponding eigengene. See details. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corPower</code></td>
<td>
<p> controls the dropoff of gene-eigengene correlation. See details. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>averageModuleSize</code></td>
<td>
<p>  average number of genes in a module. See details. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>averageExpr</code></td>
<td>
<p> average strength of module expression vectors. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>moduleSpacing</code></td>
<td>
<p> a number giving module spacing: this multiple of the module size will
lie between the module and the next one.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p> integer level of verbosity. Zero means silent, higher values make the output
progressively more and more verbose. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indent</code></td>
<td>
<p> indentation for diagnostic messages. Zero means no indentation, each unit adds
two spaces. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Module eigenvectors are chosen randomly and independently. Module sizes are chosen randomly from an
exponential distribution with mean equal <code>averageModuleSize</code>. Two thirds of genes in 
each module are simulated
as proper module genes and one third as near-module genes (see <code>simulateModule</code> for details). 
Between each successive pairs of
modules a number of genes given by <code>moduleSpacing</code> will be left unsimulated (zero expression).
Module expression, that is the
expected standard deviation of the module expression vectors, is chosen randomly from an exponential
distribution with mean equal <code>averageExpr</code>. The expression profiles are chosen such that their
correlations with the eigengene run from just below <code>maxCor</code> to <code>minCor * maxCor</code> 
(hence minCor must be
between 0 and 1, not including the bounds). The parameter <code>corPower</code> can be chosen to control the
behaviour of the simulated correlation with the gene index; values higher than 1 will result in the
correlation approaching <code>minCor * maxCor</code> faster and lower than 1 slower. 
</p>
<p>The simulated genes will be returned in the order given in <code>order</code>. 
</p>


<h3>Value</h3>

<p>A matrix of simulated gene expressions, with dimension <code>(nSamples, length(order))</code>. 
</p>


<h3>Author(s)</h3>

<p> Peter Langfelder </p>


<h3>See Also</h3>

 
<p><code>simulateModule</code> for simulation of individual modules;
</p>
<p><code>simulateDatExpr</code> for the main gene expression simulation function.
</p>


</div>