<div class="container">

<table style="width: 100%;"><tr>
<td>quantile_w</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weighted Sample Quantiles</h2>

<h3>Description</h3>

<p><code>quantile_w</code> computes the weighted population quantiles.
</p>


<h3>Usage</h3>

<pre><code class="language-R">quantile_w(x, w, probs, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>[numeric vector]</code> observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p><code>[numeric vector]</code> weights (same length as vector <code>x</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p><code>[numeric vector]</code> vector of probabilities with values
in <code>[0,1]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p><code>[logical]</code> indicating whether <code>NA</code> values should be
removed before the computation proceeds (default: <code>FALSE</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>


<dl>
<dt>Overview.</dt>
<dd>
<p><code>quantile_w</code> computes the weighted sample
quantiles; argument <code>probs</code> allows vector inputs.</p>
</dd>
<dt>Implementation.</dt>
<dd>
<p>The function is based on a weighted version of
the quickselect algorithm with the Bentley and McIlroy (1993) 3-way
partitioning scheme. For very small arrays, we use insertion sort.</p>
</dd>
<dt>Compatibility.</dt>
<dd>
<p>For equal weighting, i.e. when all elements in
<code>w</code> are equal, <code>quantile_w</code> computes quantiles that
are identical with <code>type = 2</code> in <code>stats::quantile</code>; see
also Hyndman and Fan (1996).</p>
</dd>
</dl>
<h3>Value</h3>

<p>Weighted estimate of the population quantiles.
</p>


<h3>References</h3>

<p>Bentley, J.L. and D.M. McIlroy (1993).
Engineering a Sort Function,
<em>Software - Practice and Experience</em> <b>23</b>, 1249–1265.
<a href="https://doi.org/10.1002/spe.4380231105">doi:10.1002/spe.4380231105</a>
</p>
<p>Hyndman, R.J. and Y. Fan (1996).
Sample Quantiles in Statistical Packages,
<em>The American Statistician</em> <b>50</b>, 361–365.<a href="https://doi.org/10.2307/2684934">doi:10.2307/2684934</a>
</p>


<h3>See Also</h3>

<p><code>median_w</code>
</p>


</div>