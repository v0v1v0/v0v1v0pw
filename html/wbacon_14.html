<div class="container">

<table style="width: 100%;"><tr>
<td>wBACON_reg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust Fitting Linear Regression Models by the BACON Algorithm</h2>

<h3>Description</h3>

<p>The weighted BACON algorithm is a robust method to fit weighted linear
regression models. The method is robust against outlier in the response
variable and the design matrix (leverage observation).
</p>


<h3>Usage</h3>

<pre><code class="language-R">wBACON_reg(formula, weights = NULL, data, collect = 4, na.rm = FALSE,
    alpha = 0.05, version = c("V2", "V1"), maxiter = 50, verbose = FALSE,
    original = FALSE, n_threads = 2)

## S3 method for class 'wbaconlm'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
## S3 method for class 'wbaconlm'
summary(object, ...)
## S3 method for class 'wbaconlm'
fitted(object, ...)
## S3 method for class 'wbaconlm'
residuals(object, ...)
## S3 method for class 'wbaconlm'
coef(object, ...)
## S3 method for class 'wbaconlm'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>formula</code>: a symbolic description
of the model to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p><code>[numeric]</code> sampling weight (default
<code>weights = NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a <code>data.frame</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>collect</code></td>
<td>
<p>determines the size <code class="reqn">m</code> of the initial subset to be
<code class="reqn">m = collect \cdot p</code>, where <code class="reqn">p</code> is the
number of variables, <code>[integer]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p><code>[logical]</code> indicating whether <code>NA</code> values should
be removed before the computation proceeds (default: <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p><code>[numeric]</code> tuning constant, level of significance,
<code class="reqn">0 &lt; \alpha &lt; 1</code>; (default: <code>alpha = 0.05</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>version</code></td>
<td>
<p>method to initialize the basic subset, <code>[character]</code>:
Version <code>"V1"</code> of Billor et al. (2000) yields affine
equivariant but <em>not</em> robust estimators; Version <code>"V1"</code>
yields estimators that are robust but not affine equivariant;
(default: <code>V2</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p><code>[integer]</code> maximal number of iterations (default:
<code>maxiter = 50</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p><code>[logical]</code> indicating whether additional information
is printed to the console (default: <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>original</code></td>
<td>
<p><code>[logical]</code> if <code>original = TRUE</code> the subset of
the <code class="reqn">m = collect \cdot p</code> smallest observations
(small w.r.t. to the Mahalanobis distances) is taken from the
subset generated by Algorithm 3 as the basic subset for regression
[this is the original method of Billor et al. (2000)]; otherwise
(i.e., when <code>original = FALSE</code>) the subset that results from
Algorithm 3 of Billor et al. (2000) is taken to be the basic subset
for regression (default <code>original = FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_threads</code></td>
<td>
<p><code>[integer]</code> number of threads used for OpenMP
(<code>default: 2</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p><code>[integer]</code> minimal number of significant digits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class <code>wbaconlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class <code>wbaconlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to the method.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>First, the <code>wBACON</code> method is applied to the model's design
matrix (having removed the regression intercept/constant, if there is
a constant) to establish a subset of observations which is supposed to
be free of outliers. Second, the so generated subset is regressed onto
the corresponding subset of response variables. The subset is iteratively
enlarged to include as many “good” observations as possible.
</p>
<p>The original approach of Billor et al. (2000) obtains by specifying
the argument <code>original = TRUE</code>.
</p>
<p>Models for <code>wBACON_reg</code> are specified symbolically. A typical model
has the form <code>response ~ terms</code>, where <code>response</code> is the
(numeric) response vector and <code>terms</code> is a series of terms
which specifies a linear predictor for response.
</p>
<p>A <code>formula</code> has an implied intercept term. To remove this use
either <code>y ~ x - 1</code> or <code>y ~ 0 + x</code>. See <code>formula</code>
or <code>lm</code> for for more details.
</p>
<p>The <code>weights</code> argument can be used to specify sampling weights or
case weights.
</p>
<p>It is <em>not</em> possible to fit multiple response variables (on the r.h.s.
of the formula, i.e. multivariate models) in one call.
</p>
<p>The method <em>cannot</em> deal with missing values. If the argument
<code>na.rm</code> is set to <code>TRUE</code> the method behaves like
<code>na.omit</code>.
</p>


<h4>Assumptions</h4>

<p>The algorithm <em>assumes</em> that the non-outlying data follow
a <em>linear</em> (homoscedastic) regression model and that the independent
variables have (roughly) an elliptically contoured distribution. “Although
the algorithms will often do something reasonable even when these
assumptions are violated, it is hard to say what the results mean.”
(Billor et al., 2000, p. 289)
</p>
<p>In line with Billor et al. (2000, p. 290), we use the term
outlier “nomination” rather than “detection” to highlight that algorithms
should not go beyond nominating observations as <em>potential</em> outliers.
It is left to the analyst to finally label outlying observations as such.
</p>



<h4>Utility functions and tools</h4>

<p>The generic functions <code>coef</code>, <code>fitted</code>, <code>residuals</code>,
and <code>vcov</code> extract the estimate coefficients, fitted values,
residuals, and the covariance matrix of the estimated coefficients.
</p>
<p>The function <code>summary</code> summarizes the estimated model.
</p>



<h3>Value</h3>

<p>An object of class <code>wbaconlm</code> with slots
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a named vector of coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>the residuals (for all observations in the data.frame
not only the ones in the final subset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>the numeric rank of the fitted linear model (i.e.. number of
variables in the design matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>fitted values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.residual</code></td>
<td>
<p>the residual degrees of freedom (computed for the
observations in the final subset)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>the <code>terms</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>the <code>model.frame</code> used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qr</code></td>
<td>
<p>the <code>qr</code> object of the linear model fit for
the final subset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>the subset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reg</code></td>
<td>
<p>a list with additional details on <code>wBACON_reg</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mv</code></td>
<td>
<p>a list with details on the results of <code>wBACON</code>
that have been used to initialize <code>wBACON_reg</code></p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Billor N., Hadi A.S. and Vellemann P.F. (2000). BACON: Blocked Adaptive
Computationally efficient Outlier Nominators.
<em>Computational Statistics and Data Analysis</em> <b>34</b>, pp. 279–298.
<a href="https://doi.org/10.1016/S0167-9473%2899%2900101-2">doi:10.1016/S0167-9473(99)00101-2</a>
</p>
<p>Schoch, T. (2021). wbacon: Weighted BACON algorithms for multivariate
outlier nomination (detection) and robust linear regression,
<em>Journal of Open Source Software</em> <b>6</b> (62), 3238
<a href="https://doi.org/10.21105/joss.03238">doi:10.21105/joss.03238</a>
</p>


<h3>See Also</h3>

<p><code>plot</code> gives diagnostic plots for an
<code>wbaconlm</code> object.
</p>
<p><code>predict</code> is used for prediction (incl.
confidence and prediction intervals).
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(iris)
m &lt;- wBACON_reg(Sepal.Length ~ Sepal.Width + Petal.Length + Petal.Width,
    data = iris)
m
summary(m)
</code></pre>


</div>