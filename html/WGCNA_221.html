<div class="container">

<table style="width: 100%;"><tr>
<td>qvalue</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the q-values for a given set of p-values</h2>

<h3>Description</h3>

<p>Estimate the q-values for a given set of p-values.  The q-value of a
test measures the proportion of false positives incurred (called the
false discovery rate) when that particular test is called significant.
</p>


<h3>Usage</h3>

<pre><code class="language-R">qvalue(p, lambda=seq(0,0.90,0.05), pi0.method="smoother", fdr.level=NULL, robust=FALSE,
  smooth.df=3, smooth.log.pi0=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>A vector of p-values (only necessary input)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The value of the tuning parameter to estimate
<code class="reqn">\pi_0</code>. Must be in [0,1). Optional, see Storey (2002).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi0.method</code></td>
<td>
<p>Either "smoother" or "bootstrap"; the method for
automatically choosing tuning parameter in the estimation of <code class="reqn">\pi_0</code>, 
the proportion of true null hypotheses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdr.level</code></td>
<td>
<p>A level at which to control the FDR. Must be in (0,1]. Optional; if this is
selected, a vector of TRUE and FALSE is returned that specifies
whether each q-value is less than fdr.level or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>An indicator of whether it is desired to make the
estimate more robust for small p-values and a direct finite sample 
estimate of pFDR. Optional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.df</code></td>
<td>
<p>Number of degrees-of-freedom to use when estimating <code class="reqn">\pi_0</code> 
with a smoother. Optional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.log.pi0</code></td>
<td>
<p>If TRUE and <code>pi0.method</code> = "smoother", <code class="reqn">\pi_0</code> will be 
estimated by applying a smoother to a scatterplot of <code class="reqn">log</code> <code class="reqn">\pi_0</code> estimates 
against the tuning parameter <code class="reqn">\lambda</code>. Optional.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If no options are selected, then the method used to estimate <code class="reqn">\pi_0</code> is
the smoother method described in Storey and Tibshirani (2003). The
bootstrap method is described in Storey, Taylor &amp; Siegmund (2004).
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>function call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi0</code></td>
<td>
<p>an estimate of the proportion of null p-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qvalues</code></td>
<td>
<p>a vector of the estimated q-values (the main quantity of
interest)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalues</code></td>
<td>
<p>a vector of the original p-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>significant</code></td>
<td>
<p>if fdr.level is specified, and indicator of whether the
q-value fell below fdr.level (taking all such q-values to be significant
controls FDR at level fdr.level)</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function is adapted from package qvalue. The reason we provide our own copy is that 
package qvalue contains additional functionality that relies on Tcl/Tk which has led to multiple problems.
Our copy does not require Tcl/Tk.</p>


<h3>Author(s)</h3>

<p>John D. Storey <a href="mailto:jstorey@u.washington.edu">jstorey@u.washington.edu</a>, adapted for WGCNA by Peter Langfelder</p>


<h3>References</h3>

<p>Storey JD. (2002) A direct approach to false discovery rates. Journal
of the Royal Statistical Society, Series B, 64: 479-498.
</p>
<p>Storey JD and Tibshirani R. (2003) Statistical significance for
genome-wide experiments. Proceedings of the National Academy of Sciences, 
100: 9440-9445. 
</p>
<p>Storey JD. (2003) The positive false discovery rate: A Bayesian
interpretation and the q-value. Annals of Statistics, 31: 2013-2035.  
</p>
<p>Storey JD, Taylor JE, and Siegmund D. (2004) Strong control,
conservative point estimation, and simultaneous conservative
consistency of false discovery rates: A unified approach. Journal of
the Royal Statistical Society, Series B, 66: 187-205.
</p>


</div>