<div class="container">

<table style="width: 100%;"><tr>
<td>wc.avg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plot cross-wavelet power averages and wavelet coherence averages across time of two time series
</h2>

<h3>Description</h3>

<p>This function plots cross-wavelet power averages across time, or alternatively 
wavelet coherence averages, of two time series, 
which are provided by an object of class <code>"analyze.coherency"</code>. 
The vertical axis shows the Fourier periods. The horizontal axis shows the averages.
User-defined minimum and maximum levels can be applied to cross-wavelet power averages, 
minimum levels can be applied to coherence averages. 
Also, an option is given to individualize the period axis and/or axis of averages 
by specifying tick marks and labels.
</p>
<p>There is an option to label periods according to significance of
averages (if p-values are provided) at given levels of significance. 
Labels are point symbols along the line of averages which can be assigned individually.
</p>
<p>The idea to show significance levels by colors of plotting characters and its implementation 
has been adopted from Huidong Tian and Bernard Cazelles (archived R package <code>WaveletCo</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">wc.avg(WC, which.avg = "wp", exponent = 1,
   show.siglvl = TRUE, 
   siglvl = c(0.05, 0.1), 
   sigcol = c("red", "blue"), sigpch = 20, sigcex = 1,
   minimum.level = NULL, maximum.level = NULL,
   label.avg.axis = TRUE, 
   averagelab = NULL, averagetck = 0.02, averagetcl = 0.5,
   spec.avg.axis = list(at = NULL, labels = TRUE, 
                        las = 1, hadj = NA, padj = NA),
   label.period.axis = TRUE, 
   periodlab = NULL, periodtck = 0.02, periodtcl = 0.5,
   spec.period.axis = list(at = NULL, labels = TRUE, 
                           las = 1, hadj = NA, padj = NA),
   show.legend = TRUE, legend.coords = "topright", 
   main = NULL, 
   lwd = 1, col = 1, 
   lwd.axis = 1,
   verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>WC</code></td>
<td>
<p>an object of class <code>"analyze.coherency"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which.avg</code></td>
<td>
<p>Which averages should be plotted?
</p>

<table>
<tr>
<td style="text-align: right;">
                            </td>
<td style="text-align: left;"> <code>"wp"</code> </td>
<td style="text-align: left;"> : </td>
<td style="text-align: left;"> cross-wavelet power </td>
</tr>
<tr>
<td style="text-align: right;">
                            </td>
<td style="text-align: left;"> <code>"wc"</code> </td>
<td style="text-align: left;"> : </td>
<td style="text-align: left;"> wavelet coherence                            
                           </td>
</tr>
</table>
<p>Default: <code>"wp"</code>.                
</p>
</td>
</tr>
</table>
<table><tr style="vertical-align: top;">
<td><code>exponent</code></td>
<td>
<p>Exponent applied to averages before plotting; the exponent should be positive.
</p>
<p>Default: <code>1</code>.
</p>
</td>
</tr></table>
<table>
<tr style="vertical-align: top;">
<td><code>show.siglvl</code></td>
<td>
<p>Label periods according to significance of averages? (Effective only if p-values are provided.) 
</p>
<p>Default: <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>siglvl</code></td>
<td>
<p>a vector of significance levels (of any length and order). Default: <code>c(0.05, 0.1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigcol</code></td>
<td>
<p>a vector of colors (should be of same length as and correspond to <code>siglvl</code>, 
otherwise colors <code>1 : length(siglvl)</code>).
</p>
<p>Default: <code>c("red","blue")</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigpch</code></td>
<td>
<p>a vector of plotting "characters" (symbols) to use as labels of significance. 
(It should be of same length as and correspond to <code>siglvl</code> to produce different plotting labels, 
otherwise the default setting is used. A single input value affects all labels.) 
</p>
<p>Default: <code>20</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigcex</code></td>
<td>
<p>a numerical vector working as size of labels of significance. 
(It should be of same length as and correspond to <code>siglvl</code> to produce different-sized labels, 
otherwise the default setting is used.  A single input value affects all labels. 
Note that <code>sigcex</code> is affected by <code>cex</code> in <code>par</code>.) 
</p>
<p>Default: <code>1</code>.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>minimum.level</code></td>
<td>
<p>Minimum plot level of cross-wavelet power or wavelet coherence averages considered. 
</p>
<p>Default: NULL (referring to minimum level observed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maximum.level</code></td>
<td>
<p>Maximum plot level of cross-wavelet power averages considered. 
</p>
<p>Default: NULL (referring to maximum level observed). Wavelet coherence has maximum average level <code>1</code> by definition.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>label.avg.axis</code></td>
<td>
<p>Label the axis of averages? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>averagelab</code></td>
<td>
<p>Label for the axis of averages. 
</p>
<p>Default: <code>"average cross-wavelet power"</code> or <code>"average coherence"</code>, depending on <code>which.avg</code>.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>averagetck</code></td>
<td>
<p>length of tick marks on the axis of averages as a fraction of the smaller of the width or height of 
the plotting region; see <code>par</code>.  
If <code>averagetck &gt;= 0.5</code>, <code>averagetck</code> is interpreted as a fraction of the length of the axis of averages, 
so if <code>averagetck = 1</code> (and <code>averagetcl = NULL</code>), vertical grid lines will be drawn. <br>
Setting <code>averagetck = NA</code> is to use <code>averagetcl = -0.5</code> (which is the R default setting of <code>tck</code> and <code>tcl</code>).
</p>
<p>Default here: <code>0.02</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>averagetcl</code></td>
<td>
<p>length of tick marks on the axis of averages as a fraction of the height of a line of text; see <code>par</code>. 
With <code>averagetcl = -0.5</code> (which is the R default setting of <code>tcl</code>) ticks will be drawn outward.
</p>
<p>Default here: <code>0.5</code>.</p>
</td>
</tr>
</table>
<table><tr style="vertical-align: top;">
<td><code>spec.avg.axis</code></td>
<td>
<p>a list of tick mark and label specifications for individualized labeling of the axis of averages 
(only effective if <code>label.avg.axis = TRUE</code>):
</p>

<ul>
<li>
<p>[<code>at</code>:] locations of tick marks (when <code>NULL</code>, default plotting will be applied). Valid tick marks can be provided as 
numerical and non-negative values only. <br>
Default: <code>NULL</code>.
</p>
</li>
<li>
<p>[<code>labels</code>:] either a logical value specifying whether annotations at the tick marks are the tick marks themselves, 
or any vector of labels. If <code>labels</code> is non-logical, <code>at</code> should be of same length. <br>
Default: <code>TRUE</code>. 
</p>
</li>
<li>
<p>[<code>las</code>:] the style of axis labels, see <code>par</code>. <br>
Default: <code>1</code> (always horizontal).
</p>
</li>
<li>
<p>[<code>hadj</code>:] adjustment of labels horizontal to the reading direction, see <code>axis</code>. <br>
Default: <code>NA</code> (centering is used). 
</p>
</li>
<li>
<p>[<code>padj</code>:] adjustment of labels perpendicular to the reading direction (this can be a vector of adjustments for each label), 
see <code>axis</code>. <br>
Default: <code>NA</code> (centering is used).                           
</p>
</li>
</ul>
<p>Mismatches will result in a reset to default plotting.                               
</p>
</td>
</tr></table>
<table>
<tr style="vertical-align: top;">
<td><code>label.period.axis</code></td>
<td>
<p>Label the (Fourier) period axis? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>periodlab</code></td>
<td>
<p>(Fourier) period axis label. 
</p>
<p>Default: <code>"period"</code>.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>periodtck</code></td>
<td>
<p>length of tick marks on the period axis as a fraction of the smaller of the width or height 
of the plotting region; see <code>par</code>. If <code>periodtck &gt;= 0.5</code>, <code>periodtck</code> is interpreted as a fraction
of the length of the period axis, so if <code>periodtck = 1</code> (and <code>periodtcl = NULL</code>), horizontal grid lines will be drawn. <br>
Setting <code>periodtck = NA</code> is to use <code>periodtcl = -0.5</code> (which is the R default setting of <code>tck</code> and <code>tcl</code>).
</p>
<p>Default here: <code>0.02</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>periodtcl</code></td>
<td>
<p>length of tick marks on the period axis as a fraction of the height of a line of text; see <code>par</code>. 
With <code>periodtcl = -0.5</code> (which is the R default setting of <code>tcl</code>) ticks will be drawn outward. 
</p>
<p>Default here: <code>0.5</code>.</p>
</td>
</tr>
</table>
<table><tr style="vertical-align: top;">
<td><code>spec.period.axis</code></td>
<td>
<p>a list of tick mark and label specifications for individualized period axis labeling 
(only effective if <code>label.period.axis = TRUE</code>):
</p>

<ul>
<li>
<p>[<code>at</code>:] locations of tick marks (when <code>NULL</code>, default plotting will be applied). Valid tick marks can be provided as 
numerical and positive values only. <br>
Default: <code>NULL</code>.        
</p>
</li>
<li>
<p>[<code>labels</code>:] either a logical value specifying whether annotations at the tick marks are the tick marks themselves, 
or any vector of labels. If <code>labels</code> is non-logical, <code>at</code> should be of same length. <br>
Default: <code>TRUE</code>. 
</p>
</li>
<li>
<p>[<code>las</code>:] the style of axis labels, see <code>par</code>. <br>
Default: <code>1</code> (always horizontal). 
</p>
</li>
<li>
<p>[<code>hadj</code>:] adjustment of labels horizontal to the reading direction, see <code>axis</code>. <br>
Default: <code>NA</code> (centering is used). 
</p>
</li>
<li>
<p>[<code>padj</code>:] adjustment of labels perpendicular to the reading direction (this can be a vector of adjustments for each label), 
see <code>axis</code>. <br>
Default: <code>NA</code> (centering is used).                           
</p>
</li>
</ul>
<p>Mismatches will result in a reset to default plotting.                               
</p>
</td>
</tr></table>
<table>
<tr style="vertical-align: top;">
<td><code>show.legend</code></td>
<td>
<p>Include legend of significance levels into the plot? Logical.
</p>
<p>Default: <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.coords</code></td>
<td>
<p>coordinates to position the legend (as in function <code>legend</code>). 
</p>
<p>Default: <code>"topright"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>an overall title for the plot. 
</p>
<p>Default: NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>width of line of averages. 
</p>
<p>Default: 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>color of line of averages. 
</p>
<p>Default: <code>"black"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.axis</code></td>
<td>
<p>line width of axes. 
</p>
<p>Default: 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print verbose output on the screen? Logical. 
</p>
<p>Default: <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Angi Roesch and Harald Schmidbauer; credits are also due to Huidong Tian and Bernard Cazelles.</p>


<h3>References</h3>

<p>Aguiar-Conraria L., and Soares M.J., 2011. 
Business cycle synchronization and the Euro: A wavelet analysis. 
Journal of Macroeconomics 33 (3), 477–489.
</p>
<p>Aguiar-Conraria L., and Soares M.J., 2011. 
The Continuous Wavelet Transform: A Primer. 
NIPE Working Paper Series 16/2011.
</p>
<p>Cazelles B., Chavez M., Berteaux, D., Menard F., Vik J.O., Jenouvrier S., and Stenseth N.C., 2008.
Wavelet analysis of ecological time series.
Oecologia 156, 287–304.
</p>
<p>Liu P.C., 1994. 
Wavelet spectrum analysis and ocean wind waves. 
In: Foufoula-Georgiou E., and Kumar P., (eds.), Wavelets in Geophysics, Academic Press, San Diego, 151–166.
</p>
<p>Tian, H., and Cazelles, B., 2012. <code>WaveletCo</code>. Available at <a href="https://cran.r-project.org/src/contrib/Archive/WaveletCo/">https://cran.r-project.org/src/contrib/Archive/WaveletCo/</a>, archived April 2013; accessed July 26, 2013.
</p>
<p>Torrence C., and Compo G.P., 1998. 
A practical guide to wavelet analysis.
Bulletin of the American Meteorological Society 79 (1), 61–78.
</p>
<p>Veleda D., Montagne R., and Araujo M., 2012. 
Cross-Wavelet Bias Corrected by Normalizing Scales. 
Journal of Atmospheric and Oceanic Technology 29, 1401–1408.
</p>


<h3>See Also</h3>

<p><code>analyze.coherency</code>, <code>wc.image</code>, <code>wc.sel.phases</code>, <code>wc.phasediff.image</code>, <code>wt.image</code>,
<code>wt.avg</code>, <br><code>wt.sel.phases</code>, <code>wt.phase.image</code>, <code>reconstruct</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## The following example is modified from Veleda et al., 2012:

series.length &lt;- 3*128*24
x1 &lt;- periodic.series(start.period = 1*24, length = series.length)
x2 &lt;- periodic.series(start.period = 2*24, length = series.length)
x3 &lt;- periodic.series(start.period = 4*24, length = series.length)
x4 &lt;- periodic.series(start.period = 8*24, length = series.length)
x5 &lt;- periodic.series(start.period = 16*24, length = series.length)
x6 &lt;- periodic.series(start.period = 32*24, length = series.length)
x7 &lt;- periodic.series(start.period = 64*24, length = series.length)
x8 &lt;- periodic.series(start.period = 128*24, length = series.length)

x &lt;- x1 + x2 + x3 + x4 + 3*x5 + x6 + x7 + x8 + rnorm(series.length)
y &lt;- x1 + x2 + x3 + x4 - 3*x5 + x6 + 3*x7 + x8 + rnorm(series.length)

matplot(data.frame(x, y), type = "l", lty = 1, xaxs = "i", col = 1:2, 
 xlab = "index", ylab = "",
 main = "hourly series with periods of 1, 2, 4, 8, 16, 32, 64, 128 days", 
 sub = "(out of phase at period 16, different amplitudes at period 64)")
legend("topright", legend = c("x","y"), col = 1:2, lty = 1)

## The following dates refer to the local time zone 
## (possibly allowing for daylight saving time):      
my.date &lt;- seq(as.POSIXct("2014-10-14 00:00:00", format = "%F %T"), 
               by = "hour", 
               length.out = series.length)     
my.data &lt;- data.frame(date = my.date, x = x, y = y)

## Computation of cross-wavelet power and wavelet coherence, x over y:
## a natural choice of 'dt' in the case of hourly data is 'dt = 1/24',
## resulting in one time unit equaling one day. 
## This is also the time unit in which periods are measured.
my.wc &lt;- analyze.coherency(my.data, c("x","y"), 
                           loess.span = 0, 
                           dt = 1/24, dj = 1/20, 
                           window.size.t = 1, window.size.s = 1/2, 
                           lowerPeriod = 1/4,
                           make.pval = TRUE, n.sim = 10)

## Plot of cross-wavelet power, 
## with color breakpoints according to quantiles:
wc.image(my.wc, main = "cross-wavelet power spectrum, x over y",
   legend.params = list(lab = "cross-wavelet power levels (quantiles)"),
   periodlab = "period (days)")
## Note:
## The default time axis shows an index of given points in time, 
## which is the count of hours in our example.      
## By default, arrows are plotted which show the phase differences 
## of x over y at respective significant periods. 
## (Please see our guide booklet for further explanation.)
         
## With time elapsed in days 
## (starting from 0 and proceeding in steps of 50 days)
## instead of the (default) time index:
index.ticks  &lt;- seq(1, series.length, by = 50*24)
index.labels &lt;- (index.ticks-1)/24

## Insert your specification of the time axis: 
wc.image(my.wc, color.key = "i", 
   main = "cross-wavelet power spectrum, x over y", 
   legend.params = list(lab = "cross-wavelet power levels (quantiles)"),
   periodlab = "period (days)", timelab = "time elapsed (days)",
   spec.time.axis = list(at = index.ticks, labels = index.labels))
       
## Plot of average cross-wavelet power:
wc.avg(my.wc, siglvl = 0.05, sigcol = "red", periodlab = "period (days)")

## The same plot, but with enhanced symbol size, user-defined axes, 
## minimum and a maximum plot level of averages:
wc.avg(my.wc, siglvl = 0.05, sigcol = "red", sigcex = 1.5, 
   minimum.level = 0, maximum.level = 17, 
   periodlab = "period (days)",
   spec.period.axis = list(at = c(1,2,4,8,16,32,64,128)), 
   spec.avg.axis = list(at = seq(0,16,2)), 
   lwd = 1.5)
       
## Another style of the plot:
## 'cex.axis' in 'par' controls for the size of axis tick labels, 
## while 'cex.lab' controls for the size of axis and legend labels. 
## Note that scaling by 'cex' would also affect 'sigcex'. 
op &lt;- par(no.readonly = TRUE)
par(cex.lab = 1.3, cex.axis = 1.1)
wc.avg(my.wc, siglvl = 0.05, sigcol = "red", sigcex = 1.5, 
   minimum.level = 0, maximum.level = 17, 
   periodlab = "period (days)",
   spec.period.axis = list(at = c(1,2,4,8,16,32,64,128)), 
   spec.avg.axis = list(at = seq(0,16,2)),
   lwd = 1.5)
par(op)      

## Plot of wavelet coherence 
## (with color breakpoints according to quantiles):
wc.image(my.wc, which.image = "wc", main = "wavelet coherence, x over y",
   legend.params = list(label.digits = 3),
   periodlab = "period (days)")
         
## Plot of average wavelet coherence:
wc.avg(my.wc, which.avg = "wc", 
   siglvl = 0.05, sigcol = "red", legend.coords = "topleft", 
   periodlab = "period (days)", 
   lwd = 1.5)

## The same plot, setting the minimum plot level of averages to 0: 
wc.avg(my.wc, which.avg = "wc", 
   siglvl = 0.05, sigcol = "red", legend.coords = "topleft", 
   minimum.level = 0, 
   periodlab = "period (days)", 
   lwd = 1.5)
 
## Please see also the examples in our guide booklet,
## URL http://www.hs-stat.com/projects/WaveletComp/WaveletComp_guided_tour.pdf.


## End(Not run)
</code></pre>


</div>