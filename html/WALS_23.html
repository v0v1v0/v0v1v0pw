<div class="container">

<table style="width: 100%;"><tr>
<td>fitNB2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Internal function: Fits a NB2 regression via maximum likelihood with log-link
for mean and dispersion parameter.</h2>

<h3>Description</h3>

<p>Internal fitting function for NB2 regression models. Used for fitting the
starting values of the one-step ML estimators in <code>walsNB</code>. Only
works with log-link so far, no other links tested.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitNB2(X, Y, family, control = controlNB())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Design matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Count response vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Object of class <code>"familyNBWALS"</code> generated by
<code>negbinWALS</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>List of parameters for controlling the optimization process.
Use <code>controlNB</code> to generate the list.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The available parameters for controlling the optimization are documented in
<code>controlNB</code>.
</p>


<h3>Value</h3>

<p>A list with the following elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>fitted coefficients from NB2 regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>fitted dispersion parameter from NB2 regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>0 indicates successful completion. All error codes except
for <code>99</code> are generated by <code>optim</code>. Possible error
codes are
</p>

<dl>
<dt><code>1</code></dt>
<dd>
<p>indicates that the iteration limit <code>maxit</code> had been reached.</p>
</dd>
<dt><code>10</code></dt>
<dd>
<p>degeneracy of the Nelder-Mead simplex.</p>
</dd>
<dt><code>51</code></dt>
<dd>
<p>warning from "L-BFGS-B" method; see component <code>message</code>
for further details.</p>
</dd>
<dt><code>52</code></dt>
<dd>
<p>error from "L-BFGS-B" method; see component <code>message</code>
for further details.</p>
</dd>
<dt><code>99</code></dt>
<dd>
<p>(only possible if <code>controlNB(initMASS = TRUE)</code>) indicates
convergence issues in <code>glm.nb</code>.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ll</code></td>
<td>
<p>log-likelihood of fitted NB2 regression model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>message</code></td>
<td>
<p>If <code>controlNB(initMASS = FALSE)</code>, character string
giving any additional information returned by the optimizer, else <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>If <code>controlNB(initMASS = FALSE)</code>, contains a vector with the
starting values used for <code>optim</code>.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p>controlNB, negbinWALS, glm.nb, optim.
</p>


</div>