<div class="container">

<table style="width: 100%;"><tr>
<td>t2way</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A two-way ANOVA for trimmed means, M-estimators, and medians.
</h2>

<h3>Description</h3>

<p>The <code>t2way</code> function computes a two-way ANOVA for trimmed means with interactions effects. Corresponding post hoc tests are in <code>mcp2atm</code>. <code>pbad2way</code> performs a two-way ANOVA using M-estimators for location with <code>mcp2a</code> for post hoc tests.
</p>


<h3>Usage</h3>

<pre><code class="language-R">t2way(formula, data, tr = 0.2, ...)
pbad2way(formula, data, est = "mom", nboot = 599, pro.dis = FALSE, ...)
mcp2atm(formula, data, tr = 0.2, ...)
mcp2a(formula, data, est = "mom", nboot = 599, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>an object of class formula.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>an optional data frame for the input data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr</code></td>
<td>

<p>trim level for the mean.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>

<p>Estimate to be used for the group comparisons: either <code>"onestep"</code> for one-step M-estimator of location using Huber's Psi, <code>"mom"</code> for the modified one-step (MOM) estimator of location based on Huber's Psi, or <code>"median"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>

<p>number of bootstrap samples.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pro.dis</code></td>
<td>

<p>If <code>FALSE</code>, Mahalanobis distances are used; if <code>TRUE</code> projection distances are computed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>currently ignored.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>t2way</code> does not report any degrees of freedom since an adjusted critical value is used.
<code>pbad2way</code> returns p-values only; if it happens that the variance-covariance matrix in the Mahalanobis distance computation is singular, it is suggested to use the projection distances by setting <code>pro.dis = TRUE</code>.
</p>


<h3>Value</h3>

<p>The functions <code>t2way</code> and <code>pbad2way</code> return an object of class <code>t2way</code> containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Qa</code></td>
<td>
<p>first main effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A.p.value</code></td>
<td>
<p>p-value first main effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Qb</code></td>
<td>
<p>second main effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B.p.value</code></td>
<td>
<p>p-value second main effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Qab</code></td>
<td>
<p>interaction effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AB.p.value</code></td>
<td>
<p>p-value interaction effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>function call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varnames</code></td>
<td>
<p>variable names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim</code></td>
<td>
<p>design dimensions</p>
</td>
</tr>
</table>
<p>The functions <code>mcp2atm</code> and <code>mcp2a</code> return an object of class <code>mcp</code> containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>effects</code></td>
<td>
<p>list with post hoc comparisons for all effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>design matrix</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Wilcox, R. (2012). Introduction to Robust Estimation and Hypothesis Testing (3rd ed.). Elsevier.
</p>


<h3>See Also</h3>

<p><code>t1way</code>, <code>med1way</code>, <code>t2way</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## 2-way ANOVA on trimmed means
t2way(attractiveness ~ gender*alcohol, data = goggles)

## post hoc tests
mcp2atm(attractiveness ~ gender*alcohol, data = goggles)

## 2-way ANOVA on MOM estimator
pbad2way(attractiveness ~ gender*alcohol, data = goggles)

## post hoc tests
mcp2a(attractiveness ~ gender*alcohol, data = goggles)

## 2-way ANOVA on medians
pbad2way(attractiveness ~ gender*alcohol, data = goggles, est = "median")

## post hoc tests
mcp2a(attractiveness ~ gender*alcohol, data = goggles, est = "median")

## extract design matrix
model.matrix(mcp2a(attractiveness ~ gender*alcohol, data = goggles, est = "median"))
</code></pre>


</div>