<div class="container">

<table style="width: 100%;"><tr>
<td>changepoints</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Change-points detected by WBS or BS</h2>

<h3>Description</h3>

<p>The function applies user-specified stopping criteria to extract change-points from <code>object</code>
generated by <code>wbs</code> or <code>sbs</code>. For <code>object</code> of class 'sbs', the function returns 
change-points whose corresponding test statistic exceeds threshold given in <code>th</code>. For <code>object</code> of class 'wbs',
the change-points can be also detected using information criteria with penalties specified in <code>penalty</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">changepoints(object, ...)

## S3 method for class 'sbs'
changepoints(object, th = NULL, th.const = 1.3,
  Kmax = NULL, ...)

## S3 method for class 'wbs'
changepoints(object, th = NULL, th.const = 1.3,
  Kmax = 50, penalty = c("ssic.penalty", "bic.penalty",
  "mbic.penalty"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of 'wbs' or 'sbs' class returned by, respectively, <code>wbs</code> and <code>sbs</code> functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments that may be passed to the penalty functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>th</code></td>
<td>
<p>a vector of positive scalars</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>th.const</code></td>
<td>
<p>a vector of positive scalars</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kmax</code></td>
<td>
<p>a maximum number of change-points to be detected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>a character vector with names of penalty functions used</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For the change-point detection based on thresholding (<code>object</code> of class 'sbs' or 'wbs'), the user can either specify the thresholds in <code>th</code> directly, 
determine the maximum number <code>Kmax</code> of change-points to be detected, or let <code>th</code> depend on <code>th.const</code>.
</p>
<p>When <code>Kmax</code> is given, the function automatically sets <code>th</code> to the lowest threshold such that the number of detected change-points is lower or equal than <code>Kmax</code>. 
Note that for the BS algorithm it might be not possible to find the threshold such that exactly <code>Kmax</code> change-points are found.
</p>
<p>When  <code>th</code> and <code>Kmax</code> are omitted, the threshold value is set to
</p>
<p style="text-align: center;"><code class="reqn">th = sigma \times th.const \sqrt{2\log(n)},</code>
</p>

<p>where sigma is the Median Absolute Deviation estimate of the noise level and <code class="reqn">n</code> is the number of elements in <code>x</code>. 
</p>
<p>For the change-point detection based on information criteria (<code>object</code> of class 'wbs' only), 
the user can specify both the maximum number of change-points (<code>Kmax</code>) and a type of the penalty used. 
Parameter <code>penalty</code> should contain a list of characters with names of the functions of at least two arguments (<code>n</code> and <code>cpt</code>).
For each penalty given, the following information criterion is minimized over candidate sets of change-points <code>cpt</code>:
</p>
<p style="text-align: center;"><code class="reqn">\frac{n}{2}\log\hat{\sigma}_{k}^{2}+penalty(n,cpt),</code>
</p>

<p>where <code class="reqn">k</code> denotes the number of elements in <code class="reqn">cpt</code>, <code class="reqn">\hat{\sigma}_{k}</code> is the corresponding maximum 
likelihood estimator of the residual variance.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>Median Absolute Deviation estimate of the noise level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>th</code></td>
<td>
<p>a vector of thresholds</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.cpt.th</code></td>
<td>
<p>the number of change-points detected for each value of <code>th</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpt.th</code></td>
<td>
<p>a list with the change-points detected for each value of <code>th</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kmax</code></td>
<td>
<p>a maximum number of change-points detected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ic.curve</code></td>
<td>
<p>a list with values of the chosen information criteria</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.cpt.ic</code></td>
<td>
<p>the number of change-points detected for each information criterion considered</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpt.ic</code></td>
<td>
<p>a list with the change-points detected for each information criterion considered</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">#we generates  gaussian noise + Poisson process signal with 10 jumps on average
set.seed(10)
N &lt;- rpois(1,10)
true.cpt &lt;- sample(1000,N)
m1 &lt;- matrix(rep(1:1000,N),1000,N,byrow=FALSE)
m2 &lt;- matrix(rep(true.cpt,1000),1000,N,byrow=TRUE)
x &lt;- rnorm(1000) + apply(m1&gt;=m2,1,sum)

# we apply  the BS and WBS algorithms with default values for their parameters

s &lt;- sbs(x)
w &lt;- wbs(x)

s.cpt &lt;- changepoints(s)
s.cpt

w.cpt &lt;- changepoints(w)
w.cpt

#we can use different stopping criteria, invoking sbs/wbs functions is not necessary  

s.cpt &lt;- changepoints(s,th.const=c(1,1.3))
s.cpt
w.cpt &lt;- changepoints(w,th.const=c(1,1.3))
w.cpt
</code></pre>


</div>