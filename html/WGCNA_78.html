<div class="container">

<table style="width: 100%;"><tr>
<td>corAndPvalue</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Calculation of correlations and associated p-values
</h2>

<h3>Description</h3>

<p>A faster, one-step calculation of Student correlation p-values for multiple correlations, properly taking
into account the actual number of observations. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">corAndPvalue(x, y = NULL, 
             use = "pairwise.complete.obs", 
             alternative = c("two.sided", "less", "greater"),
             ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>a vector or a matrix
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>a vector or a matrix. If <code>NULL</code>, the correlation of columns of <code>x</code> will be calculated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use</code></td>
<td>

<p>determines handling of missing data. See <code>cor</code> for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>

<p>specifies the alternative hypothesis and must be (a unique abbreviation of) one of
<code>"two.sided"</code>, <code>"greater"</code> or <code>"less"</code>.
the initial letter.  <code>"greater"</code> corresponds to positive
association, <code>"less"</code> to negative association.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>other arguments to the function <code>cor</code>. 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function calculates correlations of a matrix or of two matrices and the corresponding Student p-values.
The output is not as full-featured as <code>cor.test</code>, but can work with matrices as input.
</p>


<h3>Value</h3>

<p>A list with the following components, each a matrix:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cor</code></td>
<td>
<p>the calculated correlations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the Student p-values corresponding to the calculated correlations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>Fisher transforms of the calculated correlations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>Student t statistics of the calculated correlations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nObs</code></td>
<td>
<p>Numbers of observations for the correlation, p-values etc.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Peter Langfelder and Steve Horvath 
</p>


<h3>References</h3>

<p>Peter Langfelder, Steve Horvath (2012)
Fast R Functions for Robust Correlations and Hierarchical Clustering.
Journal of Statistical Software, 46(11), 1-17.
<a href="https://www.jstatsoft.org/v46/i11/">https://www.jstatsoft.org/v46/i11/</a>
</p>


<h3>See Also</h3>

<p><code>cor</code> for calculation of correlations only;
</p>
<p><code>cor.test</code> for another function for significance test of correlations
</p>


<h3>Examples</h3>

<pre><code class="language-R"># generate random data with non-zero correlation
set.seed(1);
a = rnorm(100);
b = rnorm(100) + a;
x = cbind(a, b);
# Call the function and display all results
corAndPvalue(x)
# Set some components to NA
x[c(1:4), 1] = NA
corAndPvalue(x)
# Note that changed number of observations.
</code></pre>


</div>