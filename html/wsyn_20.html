<div class="container">

<table style="width: 100%;"><tr>
<td>fastcohtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fast algorithm for significance testing coherence using Fourier surrogates</h2>

<h3>Description</h3>

<p>This is the algorithm of Sheppard et al. (2017) (see references).
</p>


<h3>Usage</h3>

<pre><code class="language-R">fastcohtest(
  dat1,
  dat2,
  scale.min,
  scale.max.input,
  sigma,
  f0,
  nrand,
  randnums,
  randbits,
  norm
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat1</code></td>
<td>
<p>A locations (rows) x time (columns) matrix (for spatial coherence), or a single time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat2</code></td>
<td>
<p>Same format as <code>dat1</code>, same locations and times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.min</code></td>
<td>
<p>The smallest scale of fluctuation that will be examined. At least 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.max.input</code></td>
<td>
<p>The largest scale of fluctuation guaranteed to be examined</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>The ratio of each time scale examined relative to the next timescale. Should be greater than 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f0</code></td>
<td>
<p>The ratio of the period of fluctuation to the width of the envelope</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrand</code></td>
<td>
<p>Number of surrogate randomizations to use for significance testing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randnums</code></td>
<td>
<p>A bunch of independent random numbers uniformly distributed on (0,1).
There must be <code>nrand*floor((dim(dat1)[2]-1)/2)</code> of these.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randbits</code></td>
<td>
<p>A bunch of random bits (0 or 1). There must be <code>nrand</code> of these if time
series are of odd length and <code>2*nrand</code> if even length. You may pass more than this, so,
in particular, you may pass <code>2*nrand</code> for even or odd length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm</code></td>
<td>
<p>The normalization of wavelet transforms to use. Controls the version of the 
coherence that is performed. One of "none", "powall", "powind". See details in
the documentation of <code>coh</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>fastcohtest</code> returns a list with these elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>timescales</code></td>
<td>
<p>The timescales used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coher</code></td>
<td>
<p>The magnitude of this is the fast-algorithm version of the coherence between
the two datasets, for comparison with <code>scoher</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scoher</code></td>
<td>
<p>A matrix with <code>nrand</code> rows, the magnitude of each one is the 
fast-algorithm version of the coherence for a surrogate</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Internal function, minimal error checking.
</p>


<h3>Author(s)</h3>

<p>Lawrence Sheppard, <a href="mailto:lwsheppard@ku.edu">lwsheppard@ku.edu</a>; Daniel Reuman, <a href="mailto:reuman@ku.edu">reuman@ku.edu</a>
</p>


<h3>References</h3>

<p>Sheppard, L.W., et al. (2017) Rapid surrogate testing of wavelet coherences. European Physical 
Journal, Nonlinear and Biomedical Physics, 5, 1. DOI: 10.1051/epjnbp/2017000
</p>


</div>