<div class="container">

<table style="width: 100%;"><tr>
<td>searchLinesAtGivenSlope</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Search Points Forming Lines At Given Slope</h2>

<h3>Description</h3>

<p><code>searchLinesAtGivenSlope</code> searchs among set of points (2-dim) those forming line(s) with user-defined slope ('coeff'),
ie search optimal (slope-) offset parameter(s) for (regression) line(s) with given slope ('coef').
Note: larger data-sets : segment residuals to 'coeff' &amp; select most homogenous
</p>


<h3>Usage</h3>

<pre><code class="language-R">searchLinesAtGivenSlope(
  dat,
  coeff = 1.5,
  filtExtr = c(0, 1),
  minMaxDistThr = NULL,
  lmCompare = TRUE,
  indexPoints = TRUE,
  displHist = FALSE,
  displScat = FALSE,
  bestCluByDistRat = TRUE,
  neighbDiLim = NULL,
  silent = FALSE,
  debug = FALSE,
  callFrom = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>matrix or data.frame, main input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coeff</code></td>
<td>
<p>(numeric) slope to consider</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filtExtr</code></td>
<td>
<p>(integer) lower &amp; upper quantile values, remove points with extreme deviation to offset=0, (if single value: everything up to or after will be used)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minMaxDistThr</code></td>
<td>
<p>(logical) optional minumum and maximum distance threshold</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lmCompare</code></td>
<td>
<p>(logical) add'l fitting of linear regression to best results, return offset AND slope based on lm fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indexPoints</code></td>
<td>
<p>(logical) return results as list with element 'index' specifying retained points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>displHist</code></td>
<td>
<p>(logical) display histogram of residues</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>displScat</code></td>
<td>
<p>(logical) display (simple) scatter plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bestCluByDistRat</code></td>
<td>
<p>(logical) initial selection of decent clusters based on ratio overallDist/averNeighbDist (or by CV &amp; cor)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neighbDiLim</code></td>
<td>
<p>(numeric) additional threshold for (trimmed mean) neighbour-distance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>(logical) suppress messages</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>(logical) for bug-tracking: more/enhanced messages</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>callFrom</code></td>
<td>
<p>(character) allow easier tracking of messages produced</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note: The package MASS is required when using as <code>lmCompare=TRUE</code>.
For larger data the function will try using the package <code>NbClust</code> (available from CRAN) if installed.
</p>


<h3>Value</h3>

<p>This functions returns a matrix of line-characteristics  (or if indexPoints is <code>TRUE</code> then list (line-characteristics &amp; index &amp; lm-results)
</p>


<h3>See Also</h3>

<p><code>lm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(2016); ra1 &lt;- runif(300)
 dat1 &lt;- cbind(x=round(c(1:100+ra1[1:100]/5,4*ra1[1:50]),1),
  y=round(c(1:100+ra1[101:200]/5, 4*ra1[101:150]), 1))
(li1 &lt;- searchLinesAtGivenSlope(dat1, coeff=1))
</code></pre>


</div>