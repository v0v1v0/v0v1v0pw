<div class="container">

<table style="width: 100%;"><tr>
<td>mvnapp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
MVN Rectangle Probabilities
</h2>

<h3>Description</h3>

<p>Approximation to multivariate normal rectangle probabilities using methods in Joe
(1995, JASA)
</p>


<h3>Usage</h3>

<pre><code class="language-R">mvnapp(lb,ub,mu,sigma,type=1,eps=1.e-05,nsim=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>

<p>vector of lower limits of integral/probability
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ub</code></td>
<td>

<p>vector of upper limits of integral/probability
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>

<p>mean vector
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>

<p>covariance matrix, it is assumed to be positive-definite
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>indicator, type=1 refers to the first order approximation, 
type=2 is the second order approximation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>

<p>accuracy/tolerance for bivariate marginal rectangle probabilities
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>

<p>an optional integer if random permutations are used in the approximation
for dimension &gt;=6; nsim=2000 recommended for dim&gt;=6
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>

<p>rectangle probability with approximation
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>esterr</code></td>
<td>

<p>indicator of accuracy in the approximation
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ifail</code></td>
<td>

<p>= 0 if no problems
</p>
<p>&gt;= 1 if problems from using Schervish's code in dimensions 2 to 4.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Harry Joe <a href="mailto:harry.joe@ubc.ca">harry.joe@ubc.ca</a>
</p>


<h3>References</h3>

<p>Joe, H (1995). Approximations to multivariate  normal rectangle
probabilities based on conditional expectations.  <em>Journal of American Statistical
Association</em>, <b>90</b>, 957â€“964.
</p>


<h3>Examples</h3>

<pre><code class="language-R">m&lt;-2
rh&lt;-0.5
a&lt;-c(-1,-1)
b&lt;-c(1,1)
mu&lt;-rep(0,m)
s&lt;-matrix(c(1,rh,rh,1),2,2)
print(mvnapp(a,b,mu,s))
print(mvnapp(a,b,mu,s,type=2))
print(mvnapp(a,b,mu,s,type=2,nsim=3))

m&lt;-3
rh&lt;-0.3
a&lt;-c(-1,-1,-2)
b&lt;-c(1,1,.5)
mu&lt;-rep(0,m)
s&lt;-matrix(c(1,.5,.6,.5,1,.7,.6,.7,1),3,3)
print(mvnapp(a,b,mu,s))
print(mvnapp(a,b,mu,s,type=2))
print(mvnapp(a,b,mu,s,type=2,nsim=3))

m&lt;-4
rh&lt;- -0.1
a&lt;-c(-1,-2.5,-2,-1.5)
b&lt;-c(1.68,1.11,.5,.25)
mu&lt;-rep(0,m)
s&lt;-matrix(c(1,.5,.3,.4,.5,1,.5,.4,.3,.5,1,.4,.4,.4,.4,1),m,m)
print(mvnapp(a,b,mu,s))
print(mvnapp(a,b,mu,s,type=2))
print(mvnapp(a,b,mu,s,type=2,nsim=3))

m&lt;-5
rh&lt;-.4
a&lt;-rep(-1,m)
b&lt;-rep(2,m)
mu&lt;-rep(0,m)
s&lt;-matrix(c(1,rh,rh,rh,rh,rh,1,rh,rh,rh,rh,rh,1,rh,rh,rh,rh,rh,1,
       rh,rh,rh,rh,rh,1),m,m)
print(mvnapp(a,b,mu,s))
print(mvnapp(a,b,mu,s,type=2))
print(mvnapp(a,b,mu,s,type=2,nsim=3))

m&lt;-6
a&lt;-c(-1,-1,-1,-1.5,-1,-2)
b&lt;-rep(7,m)
mu&lt;-rep(0,m)
s&lt;-matrix(c(1,rh,rh,rh,rh,rh,rh,1,rh,rh,rh,rh,rh,rh,1,rh,rh,rh,rh,rh,rh,1,
       rh,rh,rh,rh,rh,rh,1,rh,rh,rh,rh,rh,rh,1),m,m)
print(mvnapp(a,b,mu,s))
print(mvnapp(a,b,mu,s,type=2))
print(mvnapp(a,b,mu,s,type=2,nsim=3))
</code></pre>


</div>